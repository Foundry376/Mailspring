{"version":3,"sources":["../src/reach.js"],"names":[],"mappings":";;;;;;;;6BAAgC,gBAAgB;;6BAC/B,gBAAgB;;;;qBAGlB,UAAU,GAAG,EAAE;;AAE1B,QAAI,KAAK,GAAG,GAAG,CAAC,KAAK,CAAC;;AAEtB,QAAI,QAAQ,GAAG,GAAG,CAAC,MAAM,CAAC;AACtB,YAAI,EAAE,YAAY;AAClB,iBAAS,EAAE,yBAAG,OAAO;AACrB,eAAO,EAAE,MAAM;AACf,cAAM,EAAE;AACJ,eAAG,EAAE,KAAK,CAAC,SAAS,CAAC,KAAK,CAAC;AAC3B,iBAAK,EAAE;AACH,mBAAG,EAAE,eAAY;;AAEb,2BAAO,KAAK,CAAC,cAAc,CAAC,IAAI,CAAC,GAAG,EAAE,yBAAG,OAAO,EAAE,MAAM,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;iBACxE;aACJ;AACD,gBAAI,EAAE;AACF,mBAAG,EAAE,eAAY;;AAEb,wBAAI,KAAK,GAAG,IAAI,CAAC,KAAK,CAAC;AACvB,2BAAO,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,IAAI,EAAE,CAAC;iBACjC;AACD,mBAAG,EAAE,aAAU,KAAK,EAAE;;AAElB,yBAAK,CAAC,cAAc,CAAC,IAAI,CAAC,GAAG,EAAE,yBAAG,OAAO,EAAE,MAAM,EAAE,KAAK,EAAE,IAAI,CAAC,IAAI,CAAC,CAAC;iBACxE;aACJ;SACJ;KACJ,CAAC,CAAC;;AAEH,QAAI,YAAY,GAAG;AACf,WAAG,EAAE,eAAY;;AAEb,gBAAI,KAAK,GAAG,KAAK,CAAC,IAAI,CAAC,IAAI,CAAC,GAAG,EAAE,yBAAG,OAAO,EAAE,OAAO,CAAC,CAAC;AACtD,gBAAI,OAAO,GAAG,EAAE,CAAC;AACjB,gBAAI,KAAK,CAAC,MAAM,EAAE;AACd,oBAAI,KAAK,GAAG,KAAK,CAAC,IAAI,CAAC,KAAK,CAAC,CAAC,CAAC,EAAE,yBAAG,OAAO,EAAE,MAAM,CAAC,CAAC;AACrD,gDAAK,KAAK,EAAE,UAAU,IAAI,EAAE;;AAExB,2BAAO,CAAC,IAAI,CAAC,IAAI,QAAQ,CAAC,EAAE,EAAE,IAAI,CAAC,CAAC,CAAC;iBACxC,CAAC,CAAC;aACN;AACD,mBAAO,OAAO,CAAC;SAClB;AACD,WAAG,EAAE,aAAU,KAAK,EAAE;;AAElB,gBAAI,KAAK,GAAG,KAAK,CAAC,YAAY,CAAC,IAAI,CAAC,GAAG,EAAE,yBAAG,OAAO,EAAE,OAAO,CAAC,CAAC;AAC9D,iBAAK,CAAC,YAAY,CAAC,KAAK,EAAE,OAAO,EAAE,yBAAG,OAAO,CAAC,CAAC;AAC/C,4CAAK,KAAK,EAAE,UAAU,IAAI,EAAE;;AAExB,oBAAI,IAAI,GAAG,IAAI,QAAQ,CAAC,IAAI,CAAC,CAAC;AAC9B,qBAAK,CAAC,WAAW,CAAC,IAAI,CAAC,GAAG,CAAC,CAAC;aAC/B,CAAC,CAAC;SACN;KACJ,CAAC;;AAGF,OAAG,CAAC,cAAc,CAAC,UAAU,IAAI,EAAE;;AAE/B,WAAG,CAAC,GAAG,CAAC,IAAI,EAAE,OAAO,EAAE,YAAY,CAAC,CAAC;KACxC,CAAC,CAAC;;AAEH,OAAG,CAAC,YAAY,CAAC,UAAU,QAAQ,EAAE;;AAEjC,WAAG,CAAC,GAAG,CAAC,QAAQ,EAAE,OAAO,EAAE,YAAY,CAAC,CAAC;KAC5C,CAAC,CAAC;CACN","file":"reach.js","sourcesContent":["import { Namespace as NS } from 'xmpp-constants';\nimport each from 'lodash.foreach';\n\n\nexport default function (JXT) {\n\n    let Utils = JXT.utils;\n\n    let ReachURI = JXT.define({\n        name: '_reachAddr',\n        namespace: NS.REACH_0,\n        element: 'addr',\n        fields: {\n            uri: Utils.attribute('uri'),\n            $desc: {\n                get: function () {\n\n                    return Utils.getSubLangText(this.xml, NS.REACH_0, 'desc', this.lang);\n                }\n            },\n            desc: {\n                get: function () {\n\n                    let descs = this.$desc;\n                    return descs[this.lang] || '';\n                },\n                set: function (value) {\n\n                    Utils.setSubLangText(this.xml, NS.REACH_0, 'desc', value, this.lang);\n                }\n            }\n        }\n    });\n\n    let reachability = {\n        get: function () {\n\n            let reach = Utils.find(this.xml, NS.REACH_0, 'reach');\n            let results = [];\n            if (reach.length) {\n                let addrs = Utils.find(reach[0], NS.REACH_0, 'addr');\n                each(addrs, function (addr) {\n\n                    results.push(new ReachURI({}, addr));\n                });\n            }\n            return results;\n        },\n        set: function (value) {\n\n            let reach = Utils.findOrCreate(this.xml, NS.REACH_0, 'reach');\n            Utils.setAttribute(reach, 'xmlns', NS.REACH_0);\n            each(value, function (info) {\n\n                let addr = new ReachURI(info);\n                reach.appendChild(addr.xml);\n            });\n        }\n    };\n\n\n    JXT.withPubsubItem(function (Item) {\n\n        JXT.add(Item, 'reach', reachability);\n    });\n\n    JXT.withPresence(function (Presence) {\n\n        JXT.add(Presence, 'reach', reachability);\n    });\n}\n"]}