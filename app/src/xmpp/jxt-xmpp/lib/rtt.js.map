{"version":3,"sources":["../src/rtt.js"],"names":[],"mappings":"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","file":"rtt.js","sourcesContent":["import { Namespace as NS } from 'xmpp-constants';\n\n\nconst TYPE_MAP = {\n    insert: 't',\n    erase: 'e',\n    wait: 'w'\n};\n\nconst ACTION_MAP = {\n    t: 'insert',\n    e: 'erase',\n    w: 'wait'\n};\n\n\nexport default function (JXT) {\n\n    let Utils = JXT.utils;\n\n    let RTT = JXT.define({\n        name: 'rtt',\n        namespace: NS.RTT_0,\n        element: 'rtt',\n        fields: {\n            id: Utils.attribute('id'),\n            event: Utils.attribute('event', 'edit'),\n            seq: Utils.numberAttribute('seq'),\n            actions: {\n                get: function () {\n\n                    let results = [];\n                    for (let i = 0, len = this.xml.childNodes.length; i < len; i++) {\n                        let child = this.xml.childNodes[i];\n                        let name = child.localName;\n                        let action = {};\n\n                        if (child.namespaceURI !== NS.RTT_0) {\n                            continue;\n                        }\n\n                        if (ACTION_MAP[name]) {\n                            action.type = ACTION_MAP[name];\n                        } else {\n                            continue;\n                        }\n\n                        let pos = Utils.getAttribute(child, 'p');\n                        if (pos) {\n                            action.pos = parseInt(pos, 10);\n                        }\n\n                        let n = Utils.getAttribute(child, 'n');\n                        if (n) {\n                            action.num = parseInt(n, 10);\n                        }\n\n                        let t = Utils.getText(child);\n                        if (t && name === 't') {\n                            action.text = t;\n                        }\n\n                        results.push(action);\n                    }\n\n                    return results;\n                },\n                set: function (actions) {\n\n                    let self = this;\n\n                    for (let i = 0, len = this.xml.childNodes.length; i < len; i++) {\n                        this.xml.removeChild(this.xml.childNodes[i]);\n                    }\n\n                    actions.forEach(function (action ) {\n\n                        if (!TYPE_MAP[action.type]) {\n                            return;\n                        }\n\n                        let child = Utils.createElement(NS.RTT_0, TYPE_MAP[action.type], NS.RTT_0);\n\n                        if (action.pos !== undefined) {\n                            Utils.setAttribute(child, 'p', action.pos.toString());\n                        }\n\n                        if (action.num) {\n                            Utils.setAttribute(child, 'n', action.num.toString());\n                        }\n\n                        if (action.text) {\n                            Utils.setText(child, action.text);\n                        }\n\n                        self.xml.appendChild(child);\n                    });\n                }\n            }\n        }\n    });\n\n\n    JXT.extendMessage(RTT);\n}\n"]}