{"version":3,"sources":["../src/presence.js"],"names":[],"mappings":"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","file":"presence.js","sourcesContent":["import { Namespace as NS } from 'xmpp-constants';\n\n\nlet internals = {};\n\n\ninternals.definePresence = function (JXT, name, namespace) {\n\n    let Utils = JXT.utils;\n\n    JXT.define({\n        name: name,\n        namespace: namespace,\n        element: 'presence',\n        topLevel: true,\n        fields: {\n            lang: Utils.langAttribute(),\n            id: Utils.attribute('id'),\n            to: Utils.jidAttribute('to', true),\n            from: Utils.jidAttribute('from', true),\n            priority: Utils.numberSub(namespace, 'priority', false, 0),\n            show: Utils.textSub(namespace, 'show'),\n            type: {\n                get: function () {\n\n                    return Utils.getAttribute(this.xml, 'type', 'available');\n                },\n                set: function (value) {\n\n                    if (value === 'available') {\n                        value = false;\n                    }\n                    Utils.setAttribute(this.xml, 'type', value);\n                }\n            },\n            $status: {\n                get: function () {\n\n                    return Utils.getSubLangText(this.xml, namespace, 'status', this.lang);\n                }\n            },\n            status: {\n                get: function () {\n\n                    let statuses = this.$status;\n                    return statuses[this.lang] || '';\n                },\n                set: function (value) {\n\n                    Utils.setSubLangText(this.xml, namespace, 'status', value, this.lang);\n                }\n            },\n            idleSince: Utils.dateSubAttribute(NS.IDLE_1, 'idle', 'since'),\n            decloak: Utils.subAttribute(NS.DECLOAKING_0, 'decloak', 'reason'),\n            avatarId: {\n                get: function () {\n\n                    let update = Utils.find(this.xml, NS.VCARD_TEMP_UPDATE, 'x');\n                    if (!update.length) {\n                        return '';\n                    }\n                    return Utils.getSubText(update[0], NS.VCARD_TEMP_UPDATE, 'photo');\n                },\n                set: function (value) {\n\n                    let update = Utils.findOrCreate(this.xml, NS.VCARD_TEMP_UPDATE, 'x');\n\n                    if (value === '') {\n                        Utils.setBoolSub(update, NS.VCARD_TEMP_UPDATE, 'photo', true);\n                    } else if (value === true) {\n                        return;\n                    } else if (value) {\n                        Utils.setSubText(update, NS.VCARD_TEMP_UPDATE, 'photo', value);\n                    } else {\n                        this.xml.removeChild(update);\n                    }\n                }\n            }\n        }\n    });\n};\n\n\nexport default function (JXT) {\n\n    internals.definePresence(JXT, 'presence', NS.CLIENT);\n    internals.definePresence(JXT, 'serverPresence', NS.SERVER);\n    internals.definePresence(JXT, 'componentPresence', NS.COMPONENT);\n}\n"]}